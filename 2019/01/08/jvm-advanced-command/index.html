<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
      
    
    
      
    
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">





  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">





  <meta name="msvalidate.01" content="1699A46CB5242072D8403C073F576423">







  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/fancybox@3/dist/css/jquery.fancybox.min.css">







<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.1.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/dragon/dragon-apple-touch-icon.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/dragon/dragon-favicon-32x32.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/dragon/dragon-favicon-16x16.png?v=7.1.2">


  <link rel="mask-icon" href="/images/dragon/dragon-logo.svg?v=7.1.2" color="#222">



  <meta name="msapplication-config" content="/images/dragon/dragon-browserconfig.xml">





<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.2',
    sidebar: {"position":"right","width":180,"display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: true,
    lazyload: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="jpsLists the instrumented Java Virtual Machines (JVMs) on the target system.如果Java进程关闭了默认开启的UsePerfData参数（-XX:-UsePerfData），那么jps/jstat将无法探知到该Java进程 123$ jps1408 Jps19 LiveCoverMain     参数 备注    m Dis">
<meta name="keywords" content="Java,JVM">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM进阶 -- JDK命令">
<meta property="og:url" content="http://zhongmingmao.me/2019/01/08/jvm-advanced-command/index.html">
<meta property="og:site_name" content="点滴积累">
<meta property="og:description" content="jpsLists the instrumented Java Virtual Machines (JVMs) on the target system.如果Java进程关闭了默认开启的UsePerfData参数（-XX:-UsePerfData），那么jps/jstat将无法探知到该Java进程 123$ jps1408 Jps19 LiveCoverMain     参数 备注    m Dis">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-04-30T05:35:06.466Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JVM进阶 -- JDK命令">
<meta name="twitter:description" content="jpsLists the instrumented Java Virtual Machines (JVMs) on the target system.如果Java进程关闭了默认开启的UsePerfData参数（-XX:-UsePerfData），那么jps/jstat将无法探知到该Java进程 123$ jps1408 Jps19 LiveCoverMain     参数 备注    m Dis">



  <link rel="alternate" href="/atom.xml" title="点滴积累" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://zhongmingmao.me/2019/01/08/jvm-advanced-command/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>JVM进阶 -- JDK命令 | 点滴积累</title>
  




  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-97268729-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-97268729-1');
    }
  </script>



  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?fad94c1137504ba7685443e9d1f2abe9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">点滴积累</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">127</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">38</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">352</span></a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhongmingmao.me/2019/01/08/jvm-advanced-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhongmingmao">
      <meta itemprop="description" content="懦夫从不启程">
      <meta itemprop="image" content="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="点滴积累">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">JVM进阶 -- JDK命令

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-01-08 20:54:58" itemprop="dateCreated datePublished" datetime="2019-01-08T20:54:58+08:00">2019-01-08</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/jvm/" itemprop="url" rel="index"><span itemprop="name">JVM</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/jvm/advanced/" itemprop="url" rel="index"><span itemprop="name">Advanced</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          
            <span id="/2019/01/08/jvm-advanced-command/" class="leancloud_visitors" data-flag-title="JVM进阶 -- JDK命令">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">24k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">43 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="jps"><a href="#jps" class="headerlink" title="jps"></a>jps</h2><p>Lists the instrumented Java Virtual Machines (JVMs) on the target system.<br>如果Java进程关闭了默认开启的UsePerfData参数（<strong>-XX:-UsePerfData</strong>），那么<strong>jps/jstat</strong>将<strong>无法探知</strong>到该Java进程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jps</span><br><span class="line">1408 Jps</span><br><span class="line">19 LiveCoverMain</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>m</td>
<td>Displays the arguments passed to the <strong>main method</strong>. The output may be null for embedded JVMs.</td>
</tr>
<tr>
<td>l</td>
<td>Displays the <strong>full package name</strong> for the application’s main class or the <strong>full path name</strong> to the application’s JAR file.</td>
</tr>
<tr>
<td>v</td>
<td>Displays the arguments passed to the <strong>JVM</strong>.</td>
</tr>
</tbody></table>
<a id="more"></a>

<h2 id="jstat"><a href="#jstat" class="headerlink" title="jstat"></a>jstat</h2><p>Monitors Java Virtual Machine (JVM) statistics.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ jstat -options</span><br><span class="line">-class</span><br><span class="line">-compiler</span><br><span class="line">-gc</span><br><span class="line">-gccapacity</span><br><span class="line">-gccause</span><br><span class="line">-gcmetacapacity</span><br><span class="line">-gcnew</span><br><span class="line">-gcnewcapacity</span><br><span class="line">-gcold</span><br><span class="line">-gcoldcapacity</span><br><span class="line">-gcutil</span><br><span class="line">-printcompilation</span><br></pre></td></tr></table></figure>

<h3 id="class"><a href="#class" class="headerlink" title="class"></a>class</h3><p>Displays statistics about the behavior of the <strong>class loader</strong>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -class 19</span><br><span class="line">Loaded  Bytes  Unloaded  Bytes     Time   </span><br><span class="line"> 15375 27526.8       54    74.3      68.95</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>Loaded</td>
<td>Number of classes loaded.</td>
</tr>
<tr>
<td>Bytes</td>
<td>Number of <strong>kBs</strong> loaded.</td>
</tr>
<tr>
<td>Unloaded</td>
<td>Number of classes unloaded.</td>
</tr>
<tr>
<td>Bytes</td>
<td>Number of <strong>Kbytes</strong> unloaded.</td>
</tr>
<tr>
<td>Time</td>
<td>Time spent performing class loading and unloading operations.</td>
</tr>
</tbody></table>
<h3 id="compiler"><a href="#compiler" class="headerlink" title="compiler"></a>compiler</h3><p>Displays statistics about the behavior of the Java HotSpot VM <strong>Just-in-Time</strong> compiler.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -compiler 19</span><br><span class="line">Compiled Failed Invalid   Time   FailedType FailedMethod</span><br><span class="line">   17421      1       0   122.19          1 org/apache/skywalking/apm/dependencies/net/bytebuddy/pool/TypePool$Default$WithLazyResolution doResolve</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>Compiled</td>
<td>Number of compilation tasks performed.</td>
</tr>
<tr>
<td>Failed</td>
<td>Number of compilations tasks failed.</td>
</tr>
<tr>
<td>Invalid</td>
<td>Number of compilation tasks that were invalidated.</td>
</tr>
<tr>
<td>Time</td>
<td>Time spent performing compilation tasks.</td>
</tr>
<tr>
<td>FailedType</td>
<td>Compile type of the <strong>last</strong> failed compilation.</td>
</tr>
<tr>
<td>FailedMethod</td>
<td>Class name and method of the <strong>last</strong> failed compilation.</td>
</tr>
</tbody></table>
<h3 id="printcompilation"><a href="#printcompilation" class="headerlink" title="printcompilation"></a>printcompilation</h3><p>Displays Java HotSpot VM <strong>compilation method</strong> statistics.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -printcompilation 19</span><br><span class="line">Compiled  Size  Type Method</span><br><span class="line">   17423    204    1 io/netty/util/internal/MpscLinkedQueue offer</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>Compiled</td>
<td>Number of compilation tasks performed by the <strong>most recently</strong> compiled method.</td>
</tr>
<tr>
<td>Size</td>
<td>Number of <strong>bytes of byte code</strong> of the <strong>most recently</strong> compiled method.</td>
</tr>
<tr>
<td>Type</td>
<td>Compilation type of the <strong>most recently</strong> compiled method.</td>
</tr>
<tr>
<td>Method</td>
<td>Class name and method name identifying the <strong>most recently</strong> compiled method.</td>
</tr>
</tbody></table>
<h3 id="gc"><a href="#gc" class="headerlink" title="gc"></a>gc</h3><p>Displays statistics about the behavior of the garbage collected heap.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jstat -gc 19</span><br><span class="line"> S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT   </span><br><span class="line">43648.0 43648.0  0.0   356.5  43776.0  17636.4  1835008.0   407774.3  91668.0 82097.8 12108.0 10130.4  33313  553.212   6      0.128  553.340</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>S0C</td>
<td>Current survivor space 0 capacity (kB).</td>
</tr>
<tr>
<td>S1C</td>
<td>Current survivor space 1 capacity (kB).</td>
</tr>
<tr>
<td>S0U</td>
<td>Survivor space 0 utilization (kB).</td>
</tr>
<tr>
<td>S1U</td>
<td>Survivor space 1 utilization (kB).</td>
</tr>
<tr>
<td>EC</td>
<td>Current eden space capacity (kB).</td>
</tr>
<tr>
<td>EU</td>
<td>Eden space utilization (kB).</td>
</tr>
<tr>
<td>OC</td>
<td>Current old space capacity (kB).</td>
</tr>
<tr>
<td>OU</td>
<td>Old space utilization (kB).</td>
</tr>
<tr>
<td>MC</td>
<td>1. Metaspace capacity (kB).<br>2. Klass Metaspace以及NoKlass Metaspace两者总共<strong>committed</strong>的内存大小</td>
</tr>
<tr>
<td>MU</td>
<td>1. Metacspace utilization (kB).<br>2. Klass Metaspace以及NoKlass Metaspace两者已经使用了的内存大小</td>
</tr>
<tr>
<td>CCSC</td>
<td>1. Compressed class space capacity (kB).<br>2. Klass Metaspace的已经committed的内存大小</td>
</tr>
<tr>
<td>CCSU</td>
<td>1. Compressed class space used (kB).<br>2. Klass Metaspace的已经被使用的内存大小</td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation garbage collection events.</td>
</tr>
<tr>
<td>YGCT</td>
<td>Young generation garbage collection time.</td>
</tr>
<tr>
<td>FGC</td>
<td>Number of full GC events.</td>
</tr>
<tr>
<td>FGCT</td>
<td>Full garbage collection time.</td>
</tr>
<tr>
<td>GCT</td>
<td>Total garbage collection time.</td>
</tr>
</tbody></table>
<p>Metaspace相关内容可参考：<a href="https://www.jianshu.com/p/92a5fbb33764" target="_blank" rel="noopener">JVM源码分析之Metaspace解密</a></p>
<h4 id="G1"><a href="#G1" class="headerlink" title="G1"></a>G1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gc -t 13903</span><br><span class="line">Timestamp        S0C    S1C    S0U    S1U      EC       EU        OC         OU       PC     PU    YGC     YGCT    FGC    FGCT     GCT</span><br><span class="line">       554652.2  0.0   8192.0  0.0   8192.0 5275648.0 4276224.0 3104768.0   755520.9  131072.0 61178.3   8219  169.021   0      0.000  169.021</span><br></pre></td></tr></table></figure>

<ol>
<li>S0C和S0U始终为0，这是因为使用G1 GC时，JVM不再设置Eden区、Survivor区和Old区的<strong>内存边界</strong>，而是将堆划分为若干个<strong>等长</strong>内存区域</li>
<li>每个内存区域都可以作为Eden区、Survivor区和Old区，并且可以在不同区域类型之间来回切换</li>
<li>因此，<strong>逻辑上只有一个Survivor区</strong>，当需要迁移Survivor区中的数据（Copying），只需要申请一个或多个内存区域，作为新的Survivor区</li>
<li>当发生垃圾回收时，JVM可能出现Survivor内存区域内的对象<strong>全被回收</strong>或者<strong>全被晋升</strong>的现象<ul>
<li>此时，JVM会将这块内存区域回收，并标记为<strong>可分配</strong></li>
<li>结果堆中可能<strong>完全没有Survivor内存区域</strong>，S1C和S1U均为0</li>
</ul>
</li>
<li>554652s = 6.4day</li>
</ol>
<h3 id="gcnew"><a href="#gcnew" class="headerlink" title="gcnew"></a>gcnew</h3><p>Displays statistics of the behavior of the <strong>new generation</strong>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gcnew 19</span><br><span class="line"> S0C    S1C    S0U    S1U   TT MTT  DSS      EC       EU     YGC     YGCT  </span><br><span class="line">43648.0 43648.0  315.7    0.0 15  15 21824.0  43776.0  16609.9  34072  566.323</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
<th>样例</th>
</tr>
</thead>
<tbody><tr>
<td>S0C</td>
<td>Current survivor space 0 capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>S1C</td>
<td>Current survivor space 1 capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>S0U</td>
<td>Survivor space 0 utilization (kB).</td>
<td></td>
</tr>
<tr>
<td>S1U</td>
<td>Survivor space 1 utilization (kB).</td>
<td></td>
</tr>
<tr>
<td>TT</td>
<td><strong>Tenuring threshold</strong>.</td>
<td>15</td>
</tr>
<tr>
<td>MTT</td>
<td><strong>Maximum tenuring threshold</strong>.</td>
<td>15</td>
</tr>
<tr>
<td>DSS</td>
<td>Desired survivor size (kB).</td>
<td>1. -XX:TargetSurvivorRatio=50<br>2. Desired percentage of survivor space used after scavenge.<br>3. 21824KB == 0.5 * S0C</td>
</tr>
<tr>
<td>EC</td>
<td>Current eden space capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>EU</td>
<td>Eden space utilization (kB).</td>
<td></td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation GC events.</td>
<td></td>
</tr>
<tr>
<td>YGCT</td>
<td>Young generation garbage collection time.</td>
<td></td>
</tr>
</tbody></table>
<h3 id="gcold"><a href="#gcold" class="headerlink" title="gcold"></a>gcold</h3><p>Displays statistics about the behavior of the <strong>old generation</strong> and <strong>metaspace</strong> statistics.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gcold 19</span><br><span class="line">   MC       MU      CCSC     CCSU       OC          OU       YGC    FGC    FGCT     GCT   </span><br><span class="line"> 92564.0  82773.0  12236.0  10223.6   1835008.0    423476.6  34693     6    0.128  575.369</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>MC</td>
<td>Metaspace capacity (kB).</td>
</tr>
<tr>
<td>MU</td>
<td>Metaspace utilization (kB).</td>
</tr>
<tr>
<td>CCSC</td>
<td>Compressed class space capacity (kB).</td>
</tr>
<tr>
<td>CCSU</td>
<td>Compressed class space used (kB).</td>
</tr>
<tr>
<td>OC</td>
<td>Current old space capacity (kB).</td>
</tr>
<tr>
<td>OU</td>
<td>Old space utilization (kB).</td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation GC events.</td>
</tr>
<tr>
<td>FGC</td>
<td>Number of full GC events.</td>
</tr>
<tr>
<td>FGCT</td>
<td>Full garbage collection time.</td>
</tr>
<tr>
<td>GCT</td>
<td>Total garbage collection time.</td>
</tr>
</tbody></table>
<h3 id="gccapacity"><a href="#gccapacity" class="headerlink" title="gccapacity"></a>gccapacity</h3><p>Displays statistics about the capacities of the generations and their corresponding spaces.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gccapacity 19</span><br><span class="line"> NGCMN    NGCMX     NGC     S0C   S1C       EC      OGCMN      OGCMX       OGC         OC       MCMN     MCMX      MC     CCSMN    CCSMX     CCSC    YGC    FGC</span><br><span class="line">131072.0 131072.0 131072.0 43648.0 43648.0  43776.0  1835008.0  1835008.0  1835008.0  1835008.0      0.0 1128448.0  91668.0      0.0 1048576.0  12108.0  33477     6</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
<th>样例</th>
</tr>
</thead>
<tbody><tr>
<td>NGCMN</td>
<td>Minimum new generation capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>NGCMX</td>
<td>Maximum new generation capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>NGC</td>
<td>Current new generation capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>S0C</td>
<td>Current survivor space 0 capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>S1C</td>
<td>Current survivor space 1 capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>EC</td>
<td>Current eden space capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>OGCMN</td>
<td>Minimum old generation capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>OGCMX</td>
<td>Maximum old generation capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>OGC</td>
<td>Current old generation capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>OC</td>
<td>Current old space capacity (kB).</td>
<td></td>
</tr>
<tr>
<td>MCMN</td>
<td>Minimum metaspace capacity (kB).</td>
<td>0</td>
</tr>
<tr>
<td>MCMX</td>
<td>Maximum metaspace capacity (kB).</td>
<td>1. Klass Metaspace以及NoKlass Metaspace两者总共的<strong>reserved</strong>的内存大小<br>2. 默认情况下Klass Metaspace是通过<strong>CompressedClassSpaceSize</strong>这个参数来reserved 1G的内存<br>3. NoKlass Metaspace默认reserved的内存大小是<strong>2*InitialBootClassLoaderMetaspaceSize</strong><br>4. 1128448KB == 1.076GB</td>
</tr>
<tr>
<td>MC</td>
<td>Metaspace capacity (kB).</td>
<td>1. Klass Metaspace以及NoKlass Metaspace两者总共<strong>committed</strong>的内存大小<br>2. 91668KB == 89.5MB</td>
</tr>
<tr>
<td>CCSMN</td>
<td>Compressed class space minimum capacity (kB).</td>
<td>0</td>
</tr>
<tr>
<td>CCSMX</td>
<td>Compressed class space maximum capacity (kB).</td>
<td>1. Klass Metaspace reserved的内存大小<br>2. 1048576KB == 1GB</td>
</tr>
<tr>
<td>CCSC</td>
<td>Compressed class space capacity (kB).</td>
<td>1. Klass Metaspace的已committed的内存大小<br>2. 12108KB == 11.8MB</td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation GC events.</td>
<td></td>
</tr>
<tr>
<td>FGC</td>
<td>Number of full GC events.</td>
<td></td>
</tr>
</tbody></table>
<h3 id="gcnewcapacity"><a href="#gcnewcapacity" class="headerlink" title="gcnewcapacity"></a>gcnewcapacity</h3><p>Displays statistics about the sizes of the new generations and its corresponding spaces.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gcnewcapacity 19</span><br><span class="line">  NGCMN      NGCMX       NGC      S0CMX     S0C     S1CMX     S1C       ECMX        EC      YGC   FGC</span><br><span class="line">  131072.0   131072.0   131072.0  43648.0  43648.0  43648.0  43648.0    43776.0    43776.0 34383     6</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>NGCMN</td>
<td>Minimum new generation capacity (kB).</td>
</tr>
<tr>
<td>NGCMX</td>
<td>Maximum new generation capacity (kB).</td>
</tr>
<tr>
<td>NGC</td>
<td>Current new generation capacity (kB).</td>
</tr>
<tr>
<td>S0CMX</td>
<td>Maximum survivor space 0 capacity (kB).</td>
</tr>
<tr>
<td>S0C</td>
<td>Current survivor space 0 capacity (kB).</td>
</tr>
<tr>
<td>S1CMX</td>
<td>Maximum survivor space 1 capacity (kB).</td>
</tr>
<tr>
<td>S1C</td>
<td>Current survivor space 1 capacity (kB).</td>
</tr>
<tr>
<td>ECMX</td>
<td>Maximum eden space capacity (kB).</td>
</tr>
<tr>
<td>EC</td>
<td>Current eden space capacity (kB).</td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation GC events.</td>
</tr>
<tr>
<td>FGC</td>
<td>Number of full GC events.</td>
</tr>
</tbody></table>
<h3 id="gcoldcapacity"><a href="#gcoldcapacity" class="headerlink" title="gcoldcapacity"></a>gcoldcapacity</h3><p>Displays statistics about the sizes of the old generation.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gcoldcapacity 19</span><br><span class="line">   OGCMN       OGCMX        OGC         OC       YGC   FGC    FGCT     GCT   </span><br><span class="line">  1835008.0   1835008.0   1835008.0   1835008.0 34478     6    0.128  572.454</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>OGCMN</td>
<td>Minimum old generation capacity (kB).</td>
</tr>
<tr>
<td>OGCMX</td>
<td>Maximum old generation capacity (kB).</td>
</tr>
<tr>
<td>OGC</td>
<td>Current old generation capacity (kB).</td>
</tr>
<tr>
<td>OC</td>
<td>Current old space capacity (kB).</td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation GC events.</td>
</tr>
<tr>
<td>FGC</td>
<td>Number of full GC events.</td>
</tr>
<tr>
<td>FGCT</td>
<td>Full garbage collection time.</td>
</tr>
<tr>
<td>GCT</td>
<td>Total garbage collection time.</td>
</tr>
</tbody></table>
<h3 id="gcmetacapacity"><a href="#gcmetacapacity" class="headerlink" title="gcmetacapacity"></a>gcmetacapacity</h3><p>Displays statistics about the sizes of the metaspace.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gcmetacapacity 19</span><br><span class="line">   MCMN       MCMX        MC       CCSMN      CCSMX       CCSC     YGC   FGC    FGCT     GCT   </span><br><span class="line">       0.0  1130496.0    92564.0        0.0  1048576.0    12236.0 34593     6    0.128  574.271</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>MCMN</td>
<td>Minimum metaspace capacity (kB).</td>
</tr>
<tr>
<td>MCMX</td>
<td>Maximum metaspace capacity (kB).</td>
</tr>
<tr>
<td>MC</td>
<td>Metaspace capacity (kB).</td>
</tr>
<tr>
<td>CCSMN</td>
<td>Compressed class space minimum capacity (kB).</td>
</tr>
<tr>
<td>CCSMX</td>
<td>Compressed class space maximum capacity (kB).</td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation GC events.</td>
</tr>
<tr>
<td>FGC</td>
<td>Number of full GC events.</td>
</tr>
<tr>
<td>FGCT</td>
<td>Full garbage collection time.</td>
</tr>
<tr>
<td>GCT</td>
<td>Total garbage collection time.</td>
</tr>
</tbody></table>
<h3 id="gcutil"><a href="#gcutil" class="headerlink" title="gcutil"></a>gcutil</h3><p>Displays a summary about garbage collection statistics.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gcutil 19</span><br><span class="line">  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT   </span><br><span class="line">  0.16   0.00  14.11  23.02  89.37  83.50  34596  574.184     6    0.128  574.312</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
<th>样例</th>
</tr>
</thead>
<tbody><tr>
<td>S0</td>
<td>Survivor space 0 utilization as a percentage of the space’s current capacity.</td>
<td></td>
</tr>
<tr>
<td>S1</td>
<td>Survivor space 1 utilization as a percentage of the space’s current capacity.</td>
<td></td>
</tr>
<tr>
<td>E</td>
<td>Eden space utilization as a percentage of the space’s current capacity.</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>Old space utilization as a percentage of the space’s current capacity.</td>
<td></td>
</tr>
<tr>
<td>M</td>
<td>Metaspace utilization as a percentage of the space’s current capacity.</td>
<td>1. Klass Metaspace以及NoKlass Metaspace两者总共的使用率<br>2. MC=92564.0, MU=82773.0, CCSC=12236.0, CCSU=10223.6<br>3. M = MU/MC = 89.4<br>4. 有时候M达到90%以上，不一定说明metaspace使用了很多，因为内存是慢慢commit的</td>
</tr>
<tr>
<td>CCS</td>
<td>Compressed class space utilization as a percentage.</td>
<td>1. NoKlass Metaspace的使用率<br>2. MC=92564.0, MU=82773.0, CCSC=12236.0, CCSU=10223.6<br>3. CCS = CCSU/CCSC = 83.5</td>
</tr>
<tr>
<td>YGC</td>
<td>Number of young generation GC events.</td>
<td></td>
</tr>
<tr>
<td>YGCT</td>
<td>Young generation garbage collection time.</td>
<td></td>
</tr>
<tr>
<td>FGC</td>
<td>Number of full GC events.</td>
<td></td>
</tr>
<tr>
<td>FGCT</td>
<td>Full garbage collection time.</td>
<td></td>
</tr>
<tr>
<td>GCT</td>
<td>Total garbage collection time.</td>
<td></td>
</tr>
</tbody></table>
<h3 id="gccause"><a href="#gccause" class="headerlink" title="gccause"></a>gccause</h3><p>Displays a summary about garbage collection statistics (same as -gcutil), with the cause of the <strong>last</strong> and <strong>current</strong> (when<br>applicable) garbage collection events.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jstat -gccause 19</span><br><span class="line">  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT    LGCC                 GCC                 </span><br><span class="line">  0.00   0.83   2.23  22.60  89.67  84.02  33919  563.393     6    0.128  563.521 Allocation Failure   No GC</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>备注</th>
<th>样例</th>
</tr>
</thead>
<tbody><tr>
<td>LGCC</td>
<td>Cause of <strong>last</strong> garbage collection</td>
<td>Allocation Failure</td>
</tr>
<tr>
<td>GCC</td>
<td>Cause of <strong>current</strong> garbage collection</td>
<td>No GC</td>
</tr>
</tbody></table>
<h2 id="jmap"><a href="#jmap" class="headerlink" title="jmap"></a>jmap</h2><ol>
<li>Prints shared object memory maps or heap memory details for a process, core file, or remote debug server.</li>
<li>由于jmap将访问<strong>堆中的所有对象</strong>，为了保证次此过程不被应用线程干扰<ul>
<li>jmap需要借助<strong>安全点机制</strong>，让所有线程停留在不改变堆中数据的状态</li>
</ul>
</li>
<li>因此，<strong>jmap导出的堆快照必定是安全点位置的</strong>，可能导致基于该堆快照的分析结果存在<strong>偏差</strong><ul>
<li>例如编译生成的机器码中，某些对象的生命周期在两个安全点之间，那么:live选项将无法探知到这些对象</li>
</ul>
</li>
<li>如果某个线程长时间无法跑到安全点，jmap将一直等待下去<ul>
<li>垃圾回收器会主动将jstat所需要的摘要数据保存至<strong>固定位置</strong></li>
<li>因此jstat只需要直接读取即可</li>
</ul>
</li>
<li><strong>jps/jmap/jinfo/jstack/jcmd</strong>，均依赖于JVM的<strong>Attach API</strong>，因此<strong>只能监控本地Java进程</strong></li>
<li>如果开启<code>-XX:+DisableAttachMechanism</code>，那么基于<strong>Attach API</strong>的命令也将无法执行</li>
</ol>
<h3 id="clstats"><a href="#clstats" class="headerlink" title="clstats"></a>clstats</h3><p>Prints class loader wise statistics of Java heap. For each class loader, its name, how active it is, address, parent class loader, and the number and size of classes it has loaded are printed.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ jmap -clstats 19</span><br><span class="line">Attaching to process ID 19, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.131-b11</span><br><span class="line">finding class loader instances ..done.</span><br><span class="line">computing per loader stat ..done.</span><br><span class="line">please wait.. computing liveness.liveness analysis may be inaccurate ...</span><br><span class="line">class_loader    classes bytes   parent_loader   alive?  type</span><br><span class="line"></span><br><span class="line">&lt;bootstrap&gt;     2508    4508619   null          live    &lt;internal&gt;</span><br><span class="line">0x000000009388bb88      1       1473      null          dead    sun/reflect/DelegatingClassLoader@0x0000000100009df8</span><br><span class="line">0x0000000090bcccb8      1       1472    0x0000000090024a50      dead    sun/reflect/DelegatingClassLoader@0x0000000100009df8</span><br><span class="line">...</span><br><span class="line">total = 634     12693   20378456            N/A         alive=1, dead=633           N/A</span><br></pre></td></tr></table></figure>

<h3 id="finalizerinfo"><a href="#finalizerinfo" class="headerlink" title="finalizerinfo"></a>finalizerinfo</h3><p>Prints information about objects that are awaiting finalization.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ jmap -finalizerinfo 19</span><br><span class="line">Attaching to process ID 19, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.131-b11</span><br><span class="line">Number of objects pending for finalization: 0</span><br></pre></td></tr></table></figure>

<h3 id="heap"><a href="#heap" class="headerlink" title="heap"></a>heap</h3><p>Prints a heap summary of the garbage collection used, the head configuration, and generation-wise heap usage. In addition, the number and size of interned Strings are printed.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">$ jmap -heap 19</span><br><span class="line">Attaching to process ID 19, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.131-b11</span><br><span class="line"></span><br><span class="line">using parallel threads in the new generation.</span><br><span class="line">using thread-local object allocation.</span><br><span class="line">Concurrent Mark-Sweep GC</span><br><span class="line"></span><br><span class="line">Heap Configuration:</span><br><span class="line">   MinHeapFreeRatio         = 40</span><br><span class="line">   MaxHeapFreeRatio         = 70</span><br><span class="line">   MaxHeapSize              = 2013265920 (1920.0MB)</span><br><span class="line">   NewSize                  = 134217728 (128.0MB)</span><br><span class="line">   MaxNewSize               = 134217728 (128.0MB)</span><br><span class="line">   OldSize                  = 1879048192 (1792.0MB)</span><br><span class="line">   NewRatio                 = 2</span><br><span class="line">   SurvivorRatio            = 1</span><br><span class="line">   MetaspaceSize            = 21807104 (20.796875MB)</span><br><span class="line">   CompressedClassSpaceSize = 1073741824 (1024.0MB)</span><br><span class="line">   MaxMetaspaceSize         = 17592186044415 MB</span><br><span class="line">   G1HeapRegionSize         = 0 (0.0MB)</span><br><span class="line"></span><br><span class="line">Heap Usage:</span><br><span class="line">New Generation (Eden + 1 Survivor Space):</span><br><span class="line">   capacity = 89522176 (85.375MB)</span><br><span class="line">   used     = 32297224 (30.80103302001953MB)</span><br><span class="line">   free     = 57224952 (54.57396697998047MB)</span><br><span class="line">   36.07734467937866% used</span><br><span class="line">Eden Space:</span><br><span class="line">   capacity = 44826624 (42.75MB)</span><br><span class="line">   used     = 31529392 (30.068771362304688MB)</span><br><span class="line">   free     = 13297232 (12.681228637695312MB)</span><br><span class="line">   70.33630728024488% used</span><br><span class="line">From Space:</span><br><span class="line">   capacity = 44695552 (42.625MB)</span><br><span class="line">   used     = 767832 (0.7322616577148438MB)</span><br><span class="line">   free     = 43927720 (41.892738342285156MB)</span><br><span class="line">   1.7179159125274928% used</span><br><span class="line">To Space:</span><br><span class="line">   capacity = 44695552 (42.625MB)</span><br><span class="line">   used     = 0 (0.0MB)</span><br><span class="line">   free     = 44695552 (42.625MB)</span><br><span class="line">   0.0% used</span><br><span class="line">concurrent mark-sweep generation:</span><br><span class="line">   capacity = 1879048192 (1792.0MB)</span><br><span class="line">   used     = 33776136 (32.21143341064453MB)</span><br><span class="line">   free     = 1845272056 (1759.7885665893555MB)</span><br><span class="line">   1.7975130251475744% used</span><br><span class="line"></span><br><span class="line">21703 interned Strings occupying 2142592 bytes.</span><br></pre></td></tr></table></figure>

<h3 id="histo-live"><a href="#histo-live" class="headerlink" title="histo[:live]"></a>histo[:live]</h3><p>Prints a histogram of the heap. For each Java class, the number of objects, memory size in bytes, and the fully qualified class names are printed. The JVM internal class names are printed with an asterisk (*) prefix. If the live suboption is specified, then only active objects are counted.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ jmap -histo:live 19</span><br><span class="line">num     #instances         #bytes  class name</span><br><span class="line">----------------------------------------------</span><br><span class="line">   1:         72102        6440744  [C</span><br><span class="line">   2:          5996        4159456  [B</span><br><span class="line">   3:         19079        1783760  [Ljava.lang.Object;</span><br><span class="line">   4:         71213        1709112  java.lang.String</span><br><span class="line">...</span><br><span class="line">Total        529634       28005336</span><br></pre></td></tr></table></figure>

<h3 id="dump-live-format-b-file-filename"><a href="#dump-live-format-b-file-filename" class="headerlink" title="dump:[live,] format=b, file=filename"></a>dump:[live,] format=b, file=filename</h3><p>Dumps the Java heap in <strong>hprof</strong> binary format to filename. The live suboption is optional, but when specified, only the active objects in the heap are dumped.<br>相关的JVM参数：<code>-XX:+HeapDumpAfterFullGC</code>，<code>-XX:+HeapDumpOnOutOfMemoryError</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jmap -dump:live,format=b,file=/tmp/cover.hprof 19</span><br><span class="line">Dumping heap to /tmp/cover.hprof ...</span><br><span class="line">Heap dump file created</span><br></pre></td></tr></table></figure>

<h2 id="jinfo"><a href="#jinfo" class="headerlink" title="jinfo"></a>jinfo</h2><p>Generates configuration information</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ jinfo 19</span><br><span class="line">Attaching to process ID 19, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.131-b11</span><br><span class="line">Java System Properties:</span><br><span class="line"></span><br><span class="line">java.runtime.name = Java(TM) SE Runtime Environment</span><br><span class="line">java.vm.version = 25.131-b11</span><br><span class="line">...</span><br><span class="line">conf.key = lz_live_cover</span><br><span class="line">...</span><br><span class="line">VM Flags:</span><br><span class="line">Non-default VM flags: -XX:CICompilerCount=2 -XX:+CMSClassUnloadingEnabled</span><br><span class="line">....</span><br><span class="line">Command line:  -Dconf.key=lz_live_cover -Dconf.env=pre</span><br></pre></td></tr></table></figure>

<h3 id="sysprops"><a href="#sysprops" class="headerlink" title="sysprops"></a>sysprops</h3><p>Prints Java system properties as name-value pairs.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ jinfo -sysprops 19</span><br><span class="line">Attaching to process ID 19, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.131-b11</span><br><span class="line">java.runtime.name = Java(TM) SE Runtime Environment</span><br><span class="line">java.vm.version = 25.131-b11</span><br><span class="line">...</span><br><span class="line">java.vm.vendor = Oracle Corporation</span><br><span class="line">conf.key = lz_live_cover</span><br><span class="line">...</span><br><span class="line">java.vm.name = Java HotSpot(TM) 64-Bit Server VM</span><br><span class="line">sun.java.launcher = SUN_STANDARD</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="flags"><a href="#flags" class="headerlink" title="flags"></a>flags</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ jinfo -flags 19</span><br><span class="line">Attaching to process ID 19, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.131-b11</span><br><span class="line">Non-default VM flags: -XX:CICompilerCount=2 -XX:+CMSClassUnloadingEnabled</span><br><span class="line">...</span><br><span class="line">Command line:  -Dconf.key=lz_live_cover -Dconf.env=pre</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="manageable参数"><a href="#manageable参数" class="headerlink" title="manageable参数"></a>manageable参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ java -XX:+PrintFlagsFinal -version | grep manageable</span><br><span class="line">     intx CMSAbortablePrecleanWaitMillis            = 100                                 &#123;manageable&#125;</span><br><span class="line">     intx CMSTriggerInterval                        = -1                                  &#123;manageable&#125;</span><br><span class="line">     intx CMSWaitDuration                           = 2000                                &#123;manageable&#125;</span><br><span class="line">     bool HeapDumpAfterFullGC                       = false                               &#123;manageable&#125;</span><br><span class="line">     bool HeapDumpBeforeFullGC                      = false                               &#123;manageable&#125;</span><br><span class="line">     bool HeapDumpOnOutOfMemoryError                = false                               &#123;manageable&#125;</span><br><span class="line">    ccstr HeapDumpPath                              =                                     &#123;manageable&#125;</span><br><span class="line">    uintx MaxHeapFreeRatio                          = 100                                 &#123;manageable&#125;</span><br><span class="line">    uintx MinHeapFreeRatio                          = 0                                   &#123;manageable&#125;</span><br><span class="line">     bool PrintClassHistogram                       = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintClassHistogramAfterFullGC            = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintClassHistogramBeforeFullGC           = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintConcurrentLocks                      = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintGC                                   = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintGCDateStamps                         = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintGCDetails                            = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintGCID                                 = false                               &#123;manageable&#125;</span><br><span class="line">     bool PrintGCTimeStamps                         = false                               &#123;manageable&#125;</span><br><span class="line">java version &quot;1.8.0_131&quot;</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_131-b11)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode)</span><br></pre></td></tr></table></figure>

<h3 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h3><p>Prints the name and value of the specified command-line flag.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ jinfo -flag HeapDumpAfterFullGC 19</span><br><span class="line">-XX:-HeapDumpAfterFullGC</span><br></pre></td></tr></table></figure>

<h3 id="flag-name"><a href="#flag-name" class="headerlink" title="flag [+|-]name"></a>flag [+|-]name</h3><p>Enables or disables the specified Boolean command-line flag.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ jinfo -flag +HeapDumpAfterFullGC 19</span><br><span class="line"></span><br><span class="line">$ jinfo -flag HeapDumpAfterFullGC 19</span><br><span class="line">-XX:+HeapDumpAfterFullGC</span><br></pre></td></tr></table></figure>

<h3 id="flag-name-value"><a href="#flag-name-value" class="headerlink" title="flag name=value"></a>flag name=value</h3><p>Sets the specified command-line flag to the specified value.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ jinfo -flag CMSWaitDuration=1999 19</span><br><span class="line"></span><br><span class="line">$ jinfo -flag CMSWaitDuration 19</span><br><span class="line">-XX:CMSWaitDuration=1999</span><br></pre></td></tr></table></figure>

<h2 id="jstack"><a href="#jstack" class="headerlink" title="jstack"></a>jstack</h2><p>Prints Java thread stack traces for a Java process, core file, or remote debug server.<br>jstack的一个常用应用场景为<strong>死锁检测</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">$ jstack 19120</span><br><span class="line">2019-01-10 09:53:21</span><br><span class="line">Full thread dump Java HotSpot(TM) 64-Bit Server VM (25.181-b13 mixed mode):</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&quot;t3&quot; #12 prio=5 os_prio=31 tid=0x00007faa948b4800 nid=0xf07 waiting for monitor entry [0x00007000043c8000]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">	at me.zhongmingmao.advanced.command.SyncThread.run(ThreadDeadlock.java:39)</span><br><span class="line">	- waiting to lock &lt;0x0000000795700530&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;0x0000000795700550&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&quot;t2&quot; #11 prio=5 os_prio=31 tid=0x00007faa948b4000 nid=0x3c03 waiting for monitor entry [0x0000700005581000]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">	at me.zhongmingmao.advanced.command.SyncThread.run(ThreadDeadlock.java:39)</span><br><span class="line">	- waiting to lock &lt;0x0000000795700550&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;0x0000000795700540&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&quot;t1&quot; #10 prio=5 os_prio=31 tid=0x00007faa948b3000 nid=0x4203 waiting for monitor entry [0x000070000547e000]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">	at me.zhongmingmao.advanced.command.SyncThread.run(ThreadDeadlock.java:39)</span><br><span class="line">	- waiting to lock &lt;0x0000000795700540&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;0x0000000795700530&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Found one Java-level deadlock:</span><br><span class="line">=============================</span><br><span class="line">&quot;t3&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007faa94811b58 (object 0x0000000795700530, a java.lang.Object),</span><br><span class="line">  which is held by &quot;t1&quot;</span><br><span class="line">&quot;t1&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007faa9480da08 (object 0x0000000795700540, a java.lang.Object),</span><br><span class="line">  which is held by &quot;t2&quot;</span><br><span class="line">&quot;t2&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007faa94811aa8 (object 0x0000000795700550, a java.lang.Object),</span><br><span class="line">  which is held by &quot;t3&quot;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Found 1 deadlock.</span><br></pre></td></tr></table></figure>

<h2 id="jcmd"><a href="#jcmd" class="headerlink" title="jcmd"></a>jcmd</h2><p>Sends diagnostic command requests to a running Java Virtual Machine (JVM).<br><strong>jcmd可以替代上面除了jstat之外的所有命令，并没有保留jstat的输出格式</strong></p>
<h3 id="查看进程"><a href="#查看进程" class="headerlink" title="查看进程"></a>查看进程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd -l</span><br><span class="line">19 fm.lizhi.live.cover.LiveCoverMain lz-live-cover-pre-deployment-5f45b6955d-f4xjj</span><br><span class="line">3241 sun.tools.jcmd.JCmd -l</span><br></pre></td></tr></table></figure>

<h3 id="查看性能统计"><a href="#查看性能统计" class="headerlink" title="查看性能统计"></a>查看性能统计</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 19 PerfCounter.print</span><br><span class="line">java.ci.totalTime=445938928367</span><br><span class="line">java.cls.loadedClasses=20317</span><br><span class="line">...</span><br><span class="line">java.threads.daemon=121</span><br><span class="line">java.threads.live=124</span><br><span class="line">java.threads.livePeak=125</span><br><span class="line">java.threads.started=2458</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="可执行的操作"><a href="#可执行的操作" class="headerlink" title="可执行的操作"></a>可执行的操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 19 help</span><br><span class="line">19:</span><br><span class="line">The following commands are available:</span><br><span class="line">JFR.stop</span><br><span class="line">JFR.start</span><br><span class="line">JFR.dump</span><br><span class="line">JFR.check</span><br><span class="line">VM.native_memory</span><br><span class="line">VM.check_commercial_features</span><br><span class="line">VM.unlock_commercial_features</span><br><span class="line">ManagementAgent.stop</span><br><span class="line">ManagementAgent.start_local</span><br><span class="line">ManagementAgent.start</span><br><span class="line">GC.rotate_log</span><br><span class="line">Thread.print</span><br><span class="line">GC.class_stats</span><br><span class="line">GC.class_histogram</span><br><span class="line">GC.heap_dump</span><br><span class="line">GC.run_finalization</span><br><span class="line">GC.run</span><br><span class="line">VM.uptime</span><br><span class="line">VM.flags</span><br><span class="line">VM.system_properties</span><br><span class="line">VM.command_line</span><br><span class="line">VM.version</span><br><span class="line">help</span><br></pre></td></tr></table></figure>

<h4 id="VM-uptime"><a href="#VM-uptime" class="headerlink" title="VM.uptime"></a>VM.uptime</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 19 VM.uptime</span><br><span class="line">19:</span><br><span class="line">87089.850 s</span><br></pre></td></tr></table></figure>

<h4 id="GC-run"><a href="#GC-run" class="headerlink" title="GC.run"></a>GC.run</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 19 GC.run</span><br><span class="line">19:</span><br><span class="line">Command executed successfully</span><br></pre></td></tr></table></figure>

<h4 id="Thread-print"><a href="#Thread-print" class="headerlink" title="Thread.print"></a>Thread.print</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 3721 Thread.print</span><br><span class="line">Found one Java-level deadlock:</span><br><span class="line">=============================</span><br><span class="line">&quot;t3&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007fd53105ff58 (object 0x0000000795700530, a java.lang.Object),</span><br><span class="line">  which is held by &quot;t1&quot;</span><br><span class="line">&quot;t1&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007fd53105be08 (object 0x0000000795700540, a java.lang.Object),</span><br><span class="line">  which is held by &quot;t2&quot;</span><br><span class="line">&quot;t2&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007fd53105fea8 (object 0x0000000795700550, a java.lang.Object),</span><br><span class="line">  which is held by &quot;t3&quot;</span><br></pre></td></tr></table></figure>

<h4 id="JFR"><a href="#JFR" class="headerlink" title="JFR"></a>JFR</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 3721 JFR.check</span><br><span class="line">3721:</span><br><span class="line">Java Flight Recorder not enabled.</span><br><span class="line">Use VM.unlock_commercial_features to enable.</span><br><span class="line"></span><br><span class="line">$ jcmd 3721 VM.unlock_commercial_features</span><br><span class="line">3721:</span><br><span class="line">Commercial Features now unlocked.</span><br><span class="line"></span><br><span class="line">$ jcmd 3721 JFR.check</span><br><span class="line">3721:</span><br><span class="line">No available recordings.</span><br><span class="line">Use JFR.start to start a recording.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 3721 JFR.start name=abc,duration=120s</span><br><span class="line">3721:</span><br><span class="line">Started recording 1. No limit (duration/maxsize/maxage) in use.</span><br><span class="line">Use JFR.dump name=abc,duration=120s filename=FILEPATH to copy recording data to file.</span><br><span class="line"></span><br><span class="line">$ jcmd 3721 JFR.check</span><br><span class="line">3721:</span><br><span class="line">Recording: recording=1 name=&quot;abc,duration=120s&quot; (running)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cmd 3721 JFR.dump name=abc,duration=120s filename=abc.jfr</span><br><span class="line">3721:</span><br><span class="line">Dumped recording &quot;abc,duration=120s&quot;, 391.4 kB written to:</span><br><span class="line">/Users/zhongmingmao/Documents/source_code/github/jvm_demo/abc.jfr</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ jcmd 3721 JFR.stop name=abc,duration=120s</span><br><span class="line">3721:</span><br><span class="line">Stopped recording &quot;abc,duration=120s&quot;.</span><br></pre></td></tr></table></figure>

<!-- indicate-the-source -->

      
    </div>

    
      

  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2016/07/31/concurrent-synchronized/" rel="bookmark">Java并发 -- synchronized</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2019/09/11/java-performance-gc/" rel="bookmark">Java性能 -- GC</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2019/09/09/java-performance-jit/" rel="bookmark">Java性能 -- JIT</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2019/09/13/java-performance-jvm-heap-allocation/" rel="bookmark">Java性能 -- JVM堆内存分配</a></div>
      
    </li>
  
    <li class="popular-posts-item">
      
      
      <div class="popular-posts-title"><a href="/2019/09/07/java-performance-jvm-memory-model/" rel="bookmark">Java性能 -- JVM内存模型</a></div>
      
    </li>
  
  </ul>


    

    
    
    

    

    
      
    
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>zhongmingmao</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    
    <a href="http://zhongmingmao.me/2019/01/08/jvm-advanced-command/" title="JVM进阶 -- JDK命令">http://zhongmingmao.me/2019/01/08/jvm-advanced-command/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
          
            <a href="/tags/jvm/" rel="tag"><i class="fa fa-tag"></i> JVM</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/01/07/jvm-advanced-annotation-processor/" rel="next" title="JVM进阶 -- 浅谈注解处理器">
                <i class="fa fa-chevron-left"></i> JVM进阶 -- 浅谈注解处理器
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/01/10/jvm-advanced-gui-mat/" rel="prev" title="JVM进阶 -- MAT">
                JVM进阶 -- MAT <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/dog.jpg" alt="zhongmingmao">
            
              <p class="site-author-name" itemprop="name">zhongmingmao</p>
              <div class="site-description motion-element" itemprop="description">懦夫从不启程</div>
          </div>

          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:zhongmingmao0625@gmail.com" title="E-Mail &rarr; mailto:zhongmingmao0625@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#jps"><span class="nav-number">1.</span> <span class="nav-text">jps</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jstat"><span class="nav-number">2.</span> <span class="nav-text">jstat</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#class"><span class="nav-number">2.1.</span> <span class="nav-text">class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#compiler"><span class="nav-number">2.2.</span> <span class="nav-text">compiler</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#printcompilation"><span class="nav-number">2.3.</span> <span class="nav-text">printcompilation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gc"><span class="nav-number">2.4.</span> <span class="nav-text">gc</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#G1"><span class="nav-number">2.4.1.</span> <span class="nav-text">G1</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gcnew"><span class="nav-number">2.5.</span> <span class="nav-text">gcnew</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gcold"><span class="nav-number">2.6.</span> <span class="nav-text">gcold</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gccapacity"><span class="nav-number">2.7.</span> <span class="nav-text">gccapacity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gcnewcapacity"><span class="nav-number">2.8.</span> <span class="nav-text">gcnewcapacity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gcoldcapacity"><span class="nav-number">2.9.</span> <span class="nav-text">gcoldcapacity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gcmetacapacity"><span class="nav-number">2.10.</span> <span class="nav-text">gcmetacapacity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gcutil"><span class="nav-number">2.11.</span> <span class="nav-text">gcutil</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gccause"><span class="nav-number">2.12.</span> <span class="nav-text">gccause</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jmap"><span class="nav-number">3.</span> <span class="nav-text">jmap</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#clstats"><span class="nav-number">3.1.</span> <span class="nav-text">clstats</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#finalizerinfo"><span class="nav-number">3.2.</span> <span class="nav-text">finalizerinfo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#heap"><span class="nav-number">3.3.</span> <span class="nav-text">heap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#histo-live"><span class="nav-number">3.4.</span> <span class="nav-text">histo[:live]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dump-live-format-b-file-filename"><span class="nav-number">3.5.</span> <span class="nav-text">dump:[live,] format=b, file=filename</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jinfo"><span class="nav-number">4.</span> <span class="nav-text">jinfo</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sysprops"><span class="nav-number">4.1.</span> <span class="nav-text">sysprops</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flags"><span class="nav-number">4.2.</span> <span class="nav-text">flags</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#manageable参数"><span class="nav-number">4.3.</span> <span class="nav-text">manageable参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag"><span class="nav-number">4.4.</span> <span class="nav-text">flag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag-name"><span class="nav-number">4.5.</span> <span class="nav-text">flag [+|-]name</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flag-name-value"><span class="nav-number">4.6.</span> <span class="nav-text">flag name=value</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jstack"><span class="nav-number">5.</span> <span class="nav-text">jstack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jcmd"><span class="nav-number">6.</span> <span class="nav-text">jcmd</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查看进程"><span class="nav-number">6.1.</span> <span class="nav-text">查看进程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看性能统计"><span class="nav-number">6.2.</span> <span class="nav-text">查看性能统计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可执行的操作"><span class="nav-number">6.3.</span> <span class="nav-text">可执行的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#VM-uptime"><span class="nav-number">6.3.1.</span> <span class="nav-text">VM.uptime</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GC-run"><span class="nav-number">6.3.2.</span> <span class="nav-text">GC.run</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Thread-print"><span class="nav-number">6.3.3.</span> <span class="nav-text">Thread.print</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JFR"><span class="nav-number">6.3.4.</span> <span class="nav-text">JFR</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 – <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhongmingmao</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">1.9m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">58:48</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.2</div>




        




  <script>
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=61684383";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>





        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





  



  






  













  



  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fastclick@1/lib/fastclick.min.js"></script>

  
  <script src="//cdn.jsdelivr.net/npm/jquery_lazyload@1/jquery.lazyload.min.js"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="//cdn.jsdelivr.net/npm/fancybox@3/dist/js/jquery.fancybox.pack.js"></script>

  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-reading-progress@1.1/reading_progress.min.js"></script>


  


  <script src="/js/utils.js?v=7.1.2"></script>

  <script src="/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/js/affix.js?v=7.1.2"></script>

  <script src="/js/schemes/pisces.js?v=7.1.2"></script>




  
  <script src="/js/scrollspy.js?v=7.1.2"></script>
<script src="/js/post-details.js?v=7.1.2"></script>



  


  <script src="/js/next-boot.js?v=7.1.2"></script>


  

  

  
  
  
    
  

  

  
  
  


  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  
  
  <script>
    
    function addCount(Counter) {
      var $visitors = $('.leancloud_visitors');
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', '/classes/Counter/' + counter.objectId, JSON.stringify({ time: { '__op': 'Increment', 'amount': 1 } }))
            
              .done(function() {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.time + 1);
              })
            
              .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
              })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1 }))
                .done(function() {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function() {
                  console.log('Failed to create');
                });
            
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'e2IMURVDnzc37o6emkTS4i6R-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'e2IMURVDnzc37o6emkTS4i6R-gzGzoHsz',
                'X-LC-Key': 'Vfku3wPjnVYyHe33mjB6bJXY',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            addCount(Counter);
          
        });
    });
  </script>



  

  
  

  
  

  


  

  

  

  

  

  

  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-bookmark@1/bookmark.min.js"></script>
  <script>
  
    bookmark.scrollToMark('auto', "#更多");
  
  </script>


  
<script>
  $('.highlight').not('.gist .highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      const selection = document.getSelection();
      const selected = selection.rangeCount > 0 ? selection.getRangeAt(0) : false;
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
      if (selected) {
        selection.removeAllRanges();
        selection.addRange(selected);
      }
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
